<!--extentds-->
{% extends './common/baseForBack.html' %}

<!--title-->
{% block title %}后台管理{% endblock %}

<!--sp_header-->
{% block sp_header %}

{% endblock %}

<!--content-->
{% block content %}

<div class="container">
    <div class="row">
        <div class="col-xs-2" id="myScrollspy">
            <ul class="nav nav-pills nav-stacked" data-spy="affix" data-offset-top="70">

                <li>
                    <a href="#xiaoqu_manager">
                        小区库管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#xiaoqu_manager_add">小区新增</a></li>-->
                        <!--<li><a href="#xiaoqu_manager_search">小区查找</a></li>-->
                    <!--</ul>-->
                </li>

                <li>
                    <a href="#area_manager">
                        区域管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#area_manager_add">区域及账号建设</a></li>-->
                        <!--<li><a href="#area_manager_search">区域查找及修改</a></li>-->
                    <!--</ul>-->
                </li>

                <li>
                    <a href="#wuye_keeper_manager">
                        物业人员管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#wuye_keeper_manager_add">物业管家新增</a></li>-->
                        <!--<li><a href="#wuye_keeper_manager_search">物业管家查找</a></li>-->
                    <!--</ul>-->
                </li>



                <li>
                    <a href="#source_manager">
                        房源管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#source_manager_submit">房源发布</a></li>-->
                        <!--<li><a href="#source_manager_search">房源查找</a></li>-->
                    <!--</ul>-->
                </li>

                <!--<li>-->
                    <!--<a href="#data-statistics">-->
                        <!--数据统计-->
                    <!--</a>-->
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#">小区统计</a></li>-->
                        <!--<li><a href="#">区域统计</a></li>-->
                        <!--<li><a href="#">房源统计</a></li>-->
                        <!--<li><a href="#">客户流量</a></li>-->
                        <!--<li><a href="#">房源点击</a></li>-->
                        <!--<li><a href="#">停留时间</a></li>-->
                        <!--<li><a href="#">来电量</a></li>-->
                    <!--</ul>-->
                <!--</li>-->

                <li>
                    <a href="#mansion_manager_list">
                        公寓经理管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#mansion_manager_add">公寓经理新增</a></li>-->
                        <!--<li><a href="#mansion_manager_search">公寓经理查询</a></li>-->
                    <!--</ul>-->
                </li>


                <li>
                    <a href="#mansion_keeper_list">
                        公寓管家管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#mansion_keeper_add">公寓管家新增</a></li>-->
                        <!--<li><a href="#mansion_keeper_search">公寓管家查询</a></li>-->
                    <!--</ul>-->
                </li>

                <li>
                    <a href="#comment_list">
                        评论管理
                    </a>
                    <!--<ul class="second-level-menu">-->
                        <!--<li><a href="#mansion_keeper_add">公寓管家新增</a></li>-->
                        <!--<li><a href="#mansion_keeper_search">公寓管家查询</a></li>-->
                    <!--</ul>-->
                </li>



            </ul>
        </div>
        <div class="col-xs-offset-3 col-xs-9">
            <div class="section" id="xiaoqu_manager">
                <div class="title-l1">小区库管理</div>
                <div class="section-content">
                    <div class="section" id="xiaoqu_manager_search">
                        <div class="title-l2">小区查询</div>
                        <div class="section-content">
                            <form class="form-inline" id="xiaoqu_search_form" dest="{% url 'community_search' %}">
                                <div class="form-group">
                                    <label for="xiaoqu_search_name" class="control-label">小区名称*</label>
                                    <input type="text" class="form-control" id="xiaoqu_search_name" name="xiaoqu_search_name">
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="xiaoqu">搜索</button>
                                </div>
                            </form>



                            <table class="table table-striped" data-tmpl="#xiaoqu-edit">
                                <thead>
                                <tr>
                                    <th>详细小区名称</th>
                                    <th>所在商圈</th>
                                    <th>其它关键字</th>
                                    <th>房屋类型</th>
                                    <th>建成年限</th>
                                    <th>小区档次</th>
                                    <th>安保</th>
                                </tr>
                                </thead>
                                <tbody id="xiaoqu-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="area_manager">
                <div class="title-l1">区域管理</div>
                <div class="section-content">
                    <div class="section" id="area_name_search">
                        <div class="title-l2">区域名查询</div>
                        <div class="section-content">
                            <form class="form-inline" id="area_name_search_form" dest="{% url 'get_area_name' %}">
                                <div class="form-group">
                                    <label for="area_search_name" class="control-label">区域名</label>
                                    <input type="text" class="form-control" id="area_name_search_name" name="name">
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="areaname">搜索</button>
                                </div>
                            </form>


                            <table class="table table-striped" data-tmpl="areaname">
                                <thead>
                                <tr>
                                    <th>区名称</th>
                                </tr>
                                </thead>
                                <tbody id="areaname-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="section" id="area_manager_search">
                        <div class="title-l2">区域查找</div>
                        <div class="section-content">
                            <form class="form-inline" id="area_search_form" dest="{% url 'area_search' %}">
                                <div class="form-group">
                                    <label for="area_search_name" class="control-label">区域名称*</label>
                                    <input type="text" class="form-control" id="area_search_name" name="manager_search_district">
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="area">搜索</button>
                                </div>
                            </form>


                            <table class="table table-striped" data-tmpl="#area-edit">
                                <thead>
                                <tr>
                                    <th>区账号</th>
                                    <th>区域名</th>
                                    <th>区经理姓名</th>
                                    <th>区域手机</th>
                                    <th>状态</th>
                                </tr>
                                </thead>
                                <tbody id="area-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="wuye_keeper_manager">
                <div class="title-l1">物业人员管理</div>
                <div class="section-content">
                    <div class="section" id="wuye_keeper_manager_search">
                        <div class="title-l2">物业管家查找</div>
                        <div class="section-content">
                            <form class="form-inline" id="wuye_keeper_search_form" dest="{% url 'wuye_search' %}">
                                <div class="form-group">
                                    <label for="wuye_keeper_search_account" class="control-label">小区</label>
                                    <input type="text" class="form-control" id="wuye_keeper_search_account" name="second_manager_search_company">
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="wuye-keeper">搜索</button>
                                </div>
                            </form>


                            <table class="table table-striped" data-tmpl="#wuye-keeper-edit">
                                <thead>
                                <tr>
                                    <th>账号</th>
                                    <th>所属区域管理员</th>
                                    <th>所属小区</th>
                                    <th>管家姓名</th>
                                    <th>管家手机</th>
                                    <th>状态</th>
                                </tr>
                                </thead>
                                <tbody id="wuye-keeper-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="source_manager">
                <div class="title-l1">房源管理</div>
                <div class="section-content">
                    <div class="section" id="source-manager-export">
                        <div class="title-l2">房源导出</div>
                        <div class="section-content">
                            <a class="btn btn-info btn-export" href="{% url 'download_roominfo' %}" target="_blank">导出为租房excel文件</a>
                            <a class="btn btn-info btn-export" href="{% url 'download_salehouse' %}" target="_blank">导出为卖房excel文件</a>
                        </div>
                    </div>
                    <div class="section" id="source-manager-sale-search">
                        <div class="title-l2">卖房房源搜索</div>
                        <div class="section-content">
                            <form class="form-inline" id="house_search_form" dest="/salehouse_search">
                                <div class="form-group" style="margin-right:30px;">
                                    <label class="control-label">类型：</label>
                                    <label for="no" class="checkbox-inline">
                                        <input type="radio" name="house_status" id="no" checked value="no"/>
                                        不限
                                    </label>
                                    <label for="salehouse_activated" class="checkbox-inline">
                                        <input type="radio" name="house_status" id="salehouse_activated" value="active"/>
                                        已上架
                                    </label>
                                    <label for="salehouse_canceled" class="checkbox-inline">
                                        <input type="radio" name="house_status" id="salehouse_canceled" value="cancel"/>
                                        已下架
                                    </label>
                                </div>

                                <div class="form-group">
                                    <label for="salehouse_area" class="control-label">区域：</label>
                                    <select class="form-control" id="salehouse_area" name="house_area">
                                        <option value="no">不限</option>
                                        {% for i in area_list %}
                                            <option value="{{ i.name }}">{{ i.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <input type="hidden" name="p" value="1"/>
                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="salehouse">搜索</button>
                                </div>
                            </form>

                            <input type="hidden" id="cache_salehouse_area">
                            <input type="hidden" id="cache_salehouse_status">

                            <table class="table table-striped" data-tmpl="salehouse" id="salehouse-table">
                                <thead>
                                <tr>
                                    <th>房源编号</th>
                                    <th>发布时间</th>
                                    <th>小区</th>
                                    <th>户型</th>
                                    <th>价格</th>
                                    <th>鉴定员/发布员</th>
                                    <th>经纪人/管家</th>
                                    <th>有无照片</th>
                                    <th>状态</th>
                                </tr>
                                </thead>
                                <tbody id="salehouse-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="section" id="source-manager-rent-search">
                        <div class="title-l2">租房房源搜索</div>
                        <div class="section-content">
                            <form class="form-inline" id="house_search_form" dest="/room_search">
                                <div class="form-group" style="margin-right:30px;">
                                    <label class="control-label">类型：</label>
                                    <label for="no" class="checkbox-inline">
                                        <input type="radio" name="house_status" id="no" checked value="no"/>
                                        不限
                                    </label>
                                    <label for="house_activated" class="checkbox-inline">
                                        <input type="radio" name="house_status" id="house_activated" value="active"/>
                                        已上架
                                    </label>
                                    <label for="house_canceled" class="checkbox-inline">
                                        <input type="radio" name="house_status" id="house_canceled" value="cancel"/>
                                        已下架
                                    </label>
                                </div>

                                <div class="form-group">
                                    <label for="house_area" class="control-label">区域：</label>
                                    <select class="form-control" id="house_area" name="house_area">
                                        <option value="no">不限</option>
                                        {% for i in area_list %}
                                            <option value="{{ i.name }}">{{ i.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="house">搜索</button>
                                </div>
                            </form>

                            <input type="hidden" id="cache_house_area">
                            <input type="hidden" id="cache_house_status">

                            <table class="table table-striped" data-tmpl="house" id="house-table">
                                <thead>
                                <tr>
                                    <th>房源编号</th>
                                    <th>发布时间</th>
                                    <th>小区</th>
                                    <th>户型</th>
                                    <th>价格</th>
                                    <th>入住时间</th>
                                    <th>鉴定员/发布员</th>
                                    <th>经纪人/管家</th>
                                    <th>有无照片</th>
                                    <th>状态</th>
                                </tr>
                                </thead>
                                <tbody id="house-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!--<div class="section" id="data-statistics">-->
                <!--<div class="title-l1">数据统计</div>-->
                <!--<div class="section-content">-->
                    <!--<div class="section">-->
                        <!--<div class="title-l2">小区统计</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="section">-->
                        <!--<div class="title-l2">区域统计</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="section">-->
                        <!--<div class="title-l2">房源统计</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="section">-->
                        <!--<div class="title-l2">客户流量</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="section">-->
                        <!--<div class="title-l2">房源点击</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="section">-->
                        <!--<div class="title-l2">停留时间</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="section">-->
                        <!--<div class="title-l2">来电量</div>-->
                        <!--<div class="section-content">-->

                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->

            <div class="section" id="mansion_manager_list">
                <div class="title-l1">公寓经理管理</div>
                <div class="section-content">
                    <div class="section" id="mansion_manager_search">
                        <div class="title-l2">公寓经理查找</div>
                        <div class="section-content">
                            <form class="form-inline" id="mansion_manager_search_form" dest="{% url 'mansion_manager_search' %}">
                                <div class="form-group">
                                    <label for="mansion_manager_search_account" class="control-label">公司</label>
                                    <input type="text" class="form-control" id="mansion_manager_search_account" name="manager_search_district">
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="mansion-manager">搜索</button>
                                </div>
                            </form>


                            <table class="table table-striped" data-tmpl="#mansion-manager-edit">
                                <thead>
                                <tr>
                                    <th>账号</th>
                                    <th>公司</th>
                                    <th>姓名</th>
                                    <th>手机</th>
                                    <th>状态</th>
                                </tr>
                                </thead>
                                <tbody id="mansion-manager-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="mansion_keeper_list">
                <div class="title-l1">公寓管家管理</div>
                <div class="section-content">
                    <div class="section" id="mansion_keeper_search">
                        <div class="title-l2">公寓管家查询</div>
                        <div class="section-content">
                            <form class="form-inline" id="masion_keeper_search_form" dest="{% url 'mansion_keeper_search' %}">
                                <div class="form-group">
                                    <label for="masion_keeper_search_account" class="control-label">公司*</label>
                                    <input type="text" class="form-control" id="masion_keeper_search_account" name="second_manager_search_company">
                                </div>

                                <div class="form-group">
                                    <button class="btn btn-info btn-get" data-type="mansion-keeper">搜索</button>
                                </div>
                            </form>


                            <table class="table table-striped" data-tmpl="#mansion-keeper-edit">
                                <thead>
                                <tr>
                                    <th>账号</th>
                                    <th>所属业务经理</th>
                                    <th>所属公司</th>
                                    <th>管家姓名</th>
                                    <th>管家手机</th>
                                    <th>状态</th>
                                </tr>
                                </thead>
                                <tbody id="mansion-keeper-search-result">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="comment_list">
                <div class="title-l1">评论列表</div>
                <div class="section-content">
                    <table class="table table-striped" data-tmpl="comment">
                        <thead>
                        <tr>
                            <th>房源</th>
                            <th>评论内容</th>
                            <th>状态</th>
                        </tr>
                        </thead>
                        <tbody id="comment-result">


                        </tbody>
                    </table>
                    <div id="Pagination" class="pagination"><!-- 这里显示分页 --></div>

                </div>
            </div>

        </div>
        </div>
    </div>
</div>



{% endblock %}

<!--sp_script-->
{% block sp_script %}


{% verbatim %}
<script id="xiaoqu-search" type="text/x-jquery-tmpl">
<tr data-target="${pk}">
                                    <th>${pk}</th>
                                    <th>${fields.business}</th>
                                    <th>${fields.keyword}</th>
                                    <th>${fields.type}</th>
                                    <th>${fields.year}</th>
                                    <th>${fields.level}</th>
                                    <th>${fields.security}</th>
                                </tr>

</script>

<script id="area-search" type="text/x-jquery-tmpl">
<tr data-target="${pk}">
                                    <th>${pk}</th>
                                    <th>${fields.district}</th>
                                    <th>${fields.name}</th>
                                    <th>${fields.phone}</th>
                                    <th>{{if fields.exist}}正在使用{{else}}已注销{{/if}}</th>
                                </tr>

</script>

<script id="wuye-keeper-search" type="text/x-jquery-tmpl">
<tr data-target="${pk}">
                                    <th>${pk}</th>
                                    <th>${fields.manager}</th>
                                    <th>${fields.company}</th>
                                    <th>${fields.name}</th>
                                    <th>${fields.phone}</th>
                                    <th>{{if fields.exist}}正在使用{{else}}已注销{{/if}}</th>
                                </tr>

</script>

<script id="mansion-manager-search" type="text/x-jquery-tmpl">
<tr data-target="${pk}">
                                    <th>${pk}</th>
                                    <th>${fields.district}</th>
                                    <th>${fields.name}</th>
                                    <th>${fields.phone}</th>
                                    <th>{{if fields.exist}}正在使用{{else}}已注销{{/if}}</th>
                                </tr>

</script>

<script id="mansion-keeper-search" type="text/x-jquery-tmpl">
<tr data-target="${pk}">
                                    <th>${pk}</th>
                                    <th>${fields.manager}</th>
                                    <th>${fields.company}</th>
                                    <th>${fields.name}</th>
                                    <th>${fields.phone}</th>
                                    <th>{{if fields.exist}}正在使用{{else}}已注销{{/if}}</th>
                                </tr>
</script>


<script id="house-search" type="text/x-jquery-tmpl">

<tr data-target="${pk}">
                                        <th>${pk}</th>
                                        <th>${fields.create_time}</th>
                                        <th>${fields.addr_xiaoqu}</th>
                                        <th>${fields.type_room}室${fields.type_livingroom}厅${fields.type_toilet}卫</th>
                                        <th>${fields.price}/月</th>
                                        <th>${fields.stay_intime}</th>
                                        <th>${fields.contactPerson}</th>
                                        <th>${fields.contactPerson}</th>
                                        <th>{{if fields.have_image}}有{{else}}无{{/if}}</th>
                                        <th>
                                            {{if fields.sold}}
                                                已下架
                                            {{else fields.exist}}
                                                已上架
                                            {{else}}
                                                待编辑
                                            {{/if}}
                                        </th>
                                    </tr>

</script>


<script id="salehouse-search" type="text/x-jquery-tmpl">
<tr data-target="${pk}">
                                        <th>${pk}</th>
                                        <th>${fields.create_time}</th>
                                        <th>${fields.addr_xiaoqu}</th>
                                        <th>${fields.type_room}室${fields.type_livingroom}厅${fields.type_toilet}卫</th>
                                        <th>${fields.price}万元</th>
                                        <th>${fields.contactPerson}</th>
                                        <th>${fields.contactPerson}</th>
                                        <th>{{if fields.have_image}}有{{else}}无{{/if}}</th>
                                        <th>
                                            {{if fields.sold }}
                                                已下架
                                            {{else fields.exist}}
                                                已上架
                                            {{else}}
                                                待编辑
                                            {{/if}}
                                        </th>
                                    </tr>

</script>

<script id="community-list-option" type="text/x-jquery-tmpl">
    <option value="${pk}">${pk}</option>
</script>


<script id="comment-tmpl" type="text/x-jquery-tmpl">
    <tr class="comment-item" data-target="${pk}">
                            <th><a href="/room_detail/?roomNubmer=${fields.roomNumber}" target="_blank">${fields.roomNumber}</a></th>
                            <th style="width:50%;">${fields.text}</th>
                            <th>{{if fields.ifpass == null}} 未审核 {{else}} {{if fields.ifpass == false}} 未通过 {{else}}已通过{{/if}}{{/if}}</th>
                        </tr>
</script>

<script id="areaname-search" type="text/x-jquery-tmpl">
    <tr data-target="${pk}">
        <th>${pk}</th>
    </tr>
</script>

{% endverbatim %}

<script src="/js/jquery.tmpl.min.js"></script>
<script src="/js/jquery.pagenation.js"></script>
<script>
    ;(function(){

        var m_list=JSON.parse({{ managers_js|safe }});
        var _managers=[];

        for(var i=0;i<m_list.length;i++){
            _managers.push({pk:m_list[i].pk,status:m_list[i].fields.status});
        }

        //为查询form添加ajax
        $(document).delegate(".btn-get","click",function(e){
            e.preventDefault();
            var form = $(this).parents("form");
            var type=$(this).data("type");
            var _tmpl="#"+type+"-search";
            var _wrapper="#"+type+"-search-result";
            var dest = form.attr("dest");
            var content=form.serialize();


            if(type==="salehouse" || type==='house'){
                //如果是房源搜索的话，先存储搜索结果
                var dataArr = form.serializeArray();
                $("#cache_"+type+"_status").val(dataArr[0].value);
                $("#cache_"+type+"_area").val(dataArr[1].value);
            }

            $.get(
                dest,
                content,
                function(data){
                    if(data.code==1){
                        console.log("get success");
//                        $("#house-item").tmpl(rawData).appendTo('#search-result-container');
                        $(_wrapper).empty();
                        $(_tmpl).tmpl(JSON.parse(data.context)).appendTo(_wrapper);
                        if(type==="salehouse" || type==='house'){
                            //先清空分页
                            $("#Pagination-"+type).remove();
                            //如果是房源搜索的话，就还要加上分页
                            var _pagenation='<div id="Pagination-'+type+'" class="pagination"></div>';
                            $("#"+type+"-table").after(_pagenation);

                            var _cb=type==="house"?pageHouseCB:pageSalehouseCB;

                            $("#Pagination-"+type).pagination(data.count, {
                                num_edge_entries: 1, //边缘页数
                                num_display_entries: 1, //主体页数
                                callback: _cb,
                                items_per_page:1 //每页显示1项
                            });
                        }
                    }else{
                        console.log("get failed");
                    }
                }
            )
            .error(function(){
                console.log("error");
            })
        });

        var dialogOpts = {
            title:"编辑信息",
            width:"800",
            height:"500"
        };

        //这是一个非常简单的demo实例，让列表元素分页显示
        //回调函数的作用是显示对应分页的列表项内容
        //回调函数在用户每次点击分页链接的时候执行
        //参数page_index{int整型}表示当前的索引页
        var initPagination = function() {
            var num_entries = {{ evaluation_count }};
            // 创建分页
            $("#Pagination").pagination(num_entries, {
                num_edge_entries: 1, //边缘页数
                num_display_entries: 1, //主体页数
                callback: pageselectCallback,
                items_per_page:10 //每页显示1项
            });
        }();

        function pageselectCallback(page_index, jq){
            $("#comment-result").empty();
            var _p=page_index+1;


            $.get(
                    "{% url 'evaluation_search' %}",
                    {p:_p},
                    function(data){
                        if(data.code==1){
                            $("#comment-tmpl").tmpl(JSON.parse(data.context)).appendTo($("#comment-result"));
                        }else{
                            console.log("get failed");
                        }
                    }
            )
            .error(function(){
                console.log("error");
            });
            return false;
        }


        function pageHouseCB(page_index, jq){
            $("#house-search-result").empty();
            var _p=page_index+1;
            var _status=$("#cache_house_status").val();
            var _area=$("#cache_house_area").val();

            $.get(
                    "{% url 'room_search' %}",
                    {p:_p,
                     house_status:_status,
                    house_area:_area},
                    function(data){
                        if(data.code==1){
                            $("#house-search").tmpl(JSON.parse(data.context)).appendTo($("#house-search-result"));
                        }else{
                            console.log("get failed");
                        }
                    }
            )
            .error(function(){
                console.log("error");
            });
            return false;
        }


        function pageSalehouseCB(page_index, jq){
            $("#salehouse-search-result").empty();
            var _p=page_index+1;
            var _status=$("#cache_salehouse_status").val();
            var _area=$("#cache_salehouse_area").val();

            $.get(
                    "/salehouse_search/",
                    {p:_p,
                     house_status:_status,
                    house_area:_area},
                    function(data){
                        if(data.code==1){
                            $("#salehouse-search").tmpl(JSON.parse(data.context)).appendTo($("#salehouse-search-result"));
                        }else{
                            console.log("get failed");
                        }
                    }
            )
            .error(function(){
                console.log("error");
            });
            return false;
        }




        
    })();

</script>

{% endblock %}
